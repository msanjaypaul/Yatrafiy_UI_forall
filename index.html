<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yatrafy AI: Ultimate Planner</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & DOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Hide scrollbar */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        body { background-color: #fdf2f8; font-family: 'Segoe UI', sans-serif; }
        
        /* Animations */
        .fade-in { animation: fadeIn 0.4s ease-out forwards; opacity: 0; transform: translateY(10px); }
        @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
        
        .scan-laser { 
            position: absolute; top: 0; left: 0; width: 100%; height: 2px; background: #ec4899; 
            box-shadow: 0 0 10px #ec4899; animation: scan 2s linear infinite; 
        }
        @keyframes scan { 0% { top: 0%; } 50% { top: 100%; } 100% { top: 0%; } }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen py-5">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- DATA: QUESTIONS ---
        const QUESTIONS = [
            { id: 1, text: "Let's start! What kind of trip is this?", options: ["Leisure üèñÔ∏è", "Adventure üßó", "Heritage üè∞", "Romantic ‚ù§Ô∏è"] },
            { id: 2, text: "Who are you travelling with?", options: ["Solo", "Partner", "Family", "Friends"] },
            { id: 3, text: "How many travelers?", options: ["Just Me", "2 People", "3-5 People", "6+ Group"] },
            { id: 4, text: "What's your total budget range?", options: ["‚Çπ15k - 25k", "‚Çπ30k - 50k", "‚Çπ1 Lakh+"] },
            { id: 5, text: "How many days?", options: ["Weekend (2D)", "Short (4D)", "Long (1 Week)"] },
            { id: 6, text: "Preferred Travel Mode?", options: ["Flight ‚úàÔ∏è", "Train üöÜ", "Bus üöå"] },
            { id: 7, text: "Pace of the trip?", options: ["Relaxed üßò", "Packed üéí", "Balanced ‚öñÔ∏è"] }
        ];

        const YatrafyApp = () => {
            const [messages, setMessages] = useState([
                { id: 1, sender: 'bot', type: 'text', content: "Hi! I'm Yatrafy AI. üåç I'll help you plan the perfect trip. I just need to ask 7 quick questions to curate the best experience." }
            ]);
            
            const [qIndex, setQIndex] = useState(0);
            const [quizFinished, setQuizFinished] = useState(false);
            const [isTyping, setIsTyping] = useState(false);
            const chatEndRef = useRef(null);

            useEffect(() => chatEndRef.current?.scrollIntoView({ behavior: "smooth" }), [messages, isTyping]);

            // --- MAIN LOGIC ENGINE ---
            const handleInteraction = (type, payload) => {
                
                // 1. HANDLE QUIZ ANSWERS
                if (type === 'ANSWER') {
                    addMsg('user', 'text', payload);
                    
                    if (qIndex < QUESTIONS.length - 1) {
                        setQIndex(prev => prev + 1);
                        simulateThinking(600, () => {
                            addMsg('bot', 'question', QUESTIONS[qIndex + 1]);
                        });
                    } else {
                        setQuizFinished(true);
                        simulateThinking(1500, () => {
                            addMsg('bot', 'text', "Perfect! Based on 'Family', 'Heritage' & '3-5 People', here are top 3 destinations:");
                            setTimeout(() => addMsg('bot', 'destinations', null), 800);
                        });
                    }
                }

                // 2. DESTINATION CHOSEN -> SHOW TRAVEL OPTIONS
                else if (type === 'CHOOSE_DEST') {
                    addMsg('user', 'text', `Let's go to ${payload}!`);
                    simulateThinking(1200, () => {
                        addMsg('bot', 'text', `Great choice! üè∞ ${payload} is lovely this time of year. How would you like to travel?`);
                        setTimeout(() => addMsg('bot', 'travel_options', null), 1000);
                    });
                }

                // 3. TRAVEL CHOSEN -> SHOW HOTELS
                else if (type === 'CHOOSE_TRAVEL') {
                    addMsg('user', 'text', `Book ${payload}`);
                    simulateThinking(1200, () => {
                        addMsg('bot', 'text', "Flight added. ‚úàÔ∏è Now, let's find a stay. Since you want a 'Relaxed' trip, here are resorts with great pools:");
                        setTimeout(() => addMsg('bot', 'hotel_options', null), 1000);
                    });
                }

                // 4. HOTEL CHOSEN -> SHOW ITINERARY
                else if (type === 'CHOOSE_HOTEL') {
                    addMsg('user', 'text', `Select ${payload}`);
                    simulateThinking(1500, () => {
                        addMsg('bot', 'text', "Stay confirmed. üè® I've built a detailed Day-wise plan including food & sightseeing.");
                        setTimeout(() => addMsg('bot', 'itinerary', null), 1000);
                    });
                }

                // 5. ITINERARY CONFIRMED -> PAYMENT
                else if (type === 'CONFIRM_ITINERARY') {
                    addMsg('user', 'text', "Looks amazing. Let's book.");
                    simulateThinking(1000, () => {
                        addMsg('bot', 'invoice', null);
                    });
                }

                // 6. GENERATE QR
                else if (type === 'PAY_NOW') {
                    addMsg('user', 'text', "Proceed to Payment");
                    simulateThinking(1000, () => {
                        addMsg('bot', 'qr', null);
                    });
                }

                // 7. SUCCESS
                else if (type === 'SCAN_SUCCESS') {
                    addMsg('user', 'text', "Payment Done.");
                    setIsTyping("Verifying transaction...");
                    setTimeout(() => {
                        setIsTyping(false);
                        addMsg('bot', 'success', null);
                        setTimeout(() => addMsg('bot', 'downloads', null), 1500);
                    }, 2000);
                }
            };

            // --- HELPER FUNCTIONS ---
            const addMsg = (sender, type, content) => {
                setMessages(prev => [...prev, { id: Date.now(), sender, type, content }]);
            };

            const simulateThinking = (time, cb) => {
                setIsTyping(true);
                setTimeout(() => { setIsTyping(false); cb(); }, time);
            };

            // --- RENDER ---
            return (
                <div className="w-full max-w-[420px] bg-white h-[90vh] border-[8px] border-gray-900 rounded-[3rem] overflow-hidden shadow-2xl relative flex flex-col font-sans mx-auto ring-4 ring-pink-100">
                    
                    {/* Header */}
                    <div className="bg-pink-600 p-4 pt-10 text-white z-10 shadow-lg">
                        <div className="flex justify-between items-center">
                            <div className="flex items-center gap-2">
                                <div className="w-8 h-8 bg-white text-pink-600 rounded-full flex items-center justify-center font-bold">Y</div>
                                <div>
                                    <h1 className="font-bold text-sm">Yatrafy AI</h1>
                                    <p className="text-[10px] text-pink-100 opacity-90">Concierge Mode ‚Ä¢ Online</p>
                                </div>
                            </div>
                            {!quizFinished && <div className="text-xs bg-black/20 px-2 py-1 rounded">Q {qIndex + 1}/7</div>}
                        </div>
                    </div>

                    {/* Chat Area */}
                    <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 pb-24">
                        
                        {/* Initial Start Button */}
                        {messages.length === 1 && (
                            <div className="flex justify-center mt-4">
                                <button onClick={() => handleInteraction('ANSWER', "Let's Start!")} className="bg-pink-600 text-white px-6 py-2 rounded-full text-sm font-bold shadow-md animate-bounce">
                                    Start Planning üöÄ
                                </button>
                            </div>
                        )}

                        {messages.map((msg) => (
                            <div key={msg.id} className={`flex w-full fade-in ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                                
                                {msg.sender === 'bot' && <div className="w-8 h-8 rounded-full bg-pink-100 flex items-center justify-center mr-2 mt-1 text-lg">ü§ñ</div>}
                                
                                <div className={`max-w-[85%] ${msg.type === 'text' ? (msg.sender === 'user' ? 'bg-pink-600 text-white rounded-br-none' : 'bg-white text-gray-800 border border-gray-200 rounded-bl-none shadow-sm') : 'w-full'} rounded-2xl p-3 text-sm`}>
                                    
                                    {/* PLAIN TEXT */}
                                    {msg.type === 'text' && <p>{msg.content}</p>}

                                    {/* QUESTION CARDS */}
                                    {msg.type === 'question' && (
                                        <div>
                                            <p className="font-bold text-gray-800 mb-2">{msg.content.text}</p>
                                            <div className="flex flex-wrap gap-2">
                                                {msg.content.options.map(opt => (
                                                    <button key={opt} onClick={() => handleInteraction('ANSWER', opt)} className="bg-white border border-pink-200 text-pink-700 hover:bg-pink-50 px-3 py-1.5 rounded-full text-xs font-bold transition">
                                                        {opt}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    )}

                                    {/* DESTINATIONS (CAROUSEL) */}
                                    {msg.type === 'destinations' && (
                                        <div className="flex overflow-x-auto gap-3 pb-2 no-scrollbar -mx-2 px-2">
                                            {/* Item 1: Jaipur */}
                                            <div className="min-w-[240px] bg-white rounded-xl overflow-hidden shadow-md border border-gray-100 cursor-pointer group" onClick={() => handleInteraction('CHOOSE_DEST', 'Jaipur')}>
                                                <div className="h-32 bg-gray-200 relative">
                                                    <img src="https://images.unsplash.com/photo-1477587458883-47145ed94245?auto=format&fit=crop&w=400&q=80" className="w-full h-full object-cover"/>
                                                    <div className="absolute top-2 right-2 bg-white px-2 py-0.5 rounded text-[10px] font-bold">98% Match</div>
                                                </div>
                                                <div className="p-3">
                                                    <h3 className="font-bold text-gray-800">Jaipur, Rajasthan</h3>
                                                    <p className="text-[10px] text-gray-500">Heritage ‚Ä¢ Culture ‚Ä¢ Food</p>
                                                    <button className="mt-2 w-full bg-black text-white py-1.5 rounded text-xs font-bold">Select Destination</button>
                                                </div>
                                            </div>
                                            {/* Item 2: Udaipur */}
                                            <div className="min-w-[240px] bg-white rounded-xl overflow-hidden shadow-md border border-gray-100 opacity-70">
                                                <div className="h-32 bg-gray-200 relative">
                                                    <img src="https://images.unsplash.com/photo-1615836245337-f5b9b2303f10?auto=format&fit=crop&w=400&q=80" className="w-full h-full object-cover"/>
                                                </div>
                                                <div className="p-3">
                                                    <h3 className="font-bold text-gray-800">Udaipur, Rajasthan</h3>
                                                    <p className="text-[10px] text-gray-500">Lakes ‚Ä¢ Romantic</p>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                    {/* TRAVEL OPTIONS */}
                                    {msg.type === 'travel_options' && (
                                        <div className="space-y-3">
                                            {/* Option 1: Flight */}
                                            <div className="bg-white p-3 rounded-xl border border-gray-200 shadow-sm cursor-pointer hover:border-pink-400 transition" onClick={() => handleInteraction('CHOOSE_TRAVEL', 'Indigo Flight')}>
                                                <div className="flex gap-3 items-center">
                                                    <img src="https://images.unsplash.com/photo-1436491865332-7a61a109cc05?auto=format&fit=crop&w=100&q=80" className="w-12 h-12 rounded-lg object-cover"/>
                                                    <div className="flex-1">
                                                        <div className="flex justify-between"><h3 className="font-bold text-xs">Indigo 6E-404</h3><span className="font-bold text-pink-600">‚Çπ4,200</span></div>
                                                        <p className="text-[10px] text-gray-500">06:00 AM ‚Ä¢ 1h 45m duration</p>
                                                    </div>
                                                </div>
                                            </div>
                                            {/* Option 2: Train */}
                                            <div className="bg-white p-3 rounded-xl border border-gray-200 shadow-sm opacity-80">
                                                <div className="flex gap-3 items-center">
                                                    <img src="https://images.unsplash.com/photo-1535535112387-56ffe8db21ff?auto=format&fit=crop&w=100&q=80" className="w-12 h-12 rounded-lg object-cover"/>
                                                    <div className="flex-1">
                                                        <div className="flex justify-between"><h3 className="font-bold text-xs">Vande Bharat Exp</h3><span className="font-bold text-gray-600">‚Çπ1,800</span></div>
                                                        <p className="text-[10px] text-gray-500">06:10 AM ‚Ä¢ 4h 30m duration</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                    {/* HOTEL OPTIONS */}
                                    {msg.type === 'hotel_options' && (
                                        <div className="flex overflow-x-auto gap-3 pb-2 no-scrollbar -mx-2 px-2">
                                            {/* Hotel 1 */}
                                            <div className="min-w-[220px] bg-white rounded-xl overflow-hidden shadow-md border cursor-pointer" onClick={() => handleInteraction('CHOOSE_HOTEL', 'Heritage Haveli')}>
                                                <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?auto=format&fit=crop&w=300&q=80" className="w-full h-28 object-cover"/>
                                                <div className="p-3">
                                                    <h3 className="font-bold text-gray-800 text-sm">Heritage Haveli</h3>
                                                    <p className="text-[10px] text-gray-500">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê ‚Ä¢ Pool & Spa</p>
                                                    <div className="flex justify-between mt-2">
                                                        <span className="font-bold text-pink-600 text-xs">‚Çπ8,500/n</span>
                                                        <span className="bg-pink-100 text-pink-700 px-2 rounded text-[10px]">Select</span>
                                                    </div>
                                                </div>
                                            </div>
                                            {/* Hotel 2 */}
                                            <div className="min-w-[220px] bg-white rounded-xl overflow-hidden shadow-md border opacity-60">
                                                <img src="https://images.unsplash.com/photo-1582719508461-905c673771fd?auto=format&fit=crop&w=300&q=80" className="w-full h-28 object-cover"/>
                                                <div className="p-3">
                                                    <h3 className="font-bold text-gray-600 text-sm">City Palace Hotel</h3>
                                                    <p className="text-[10px] text-gray-500">‚≠ê‚≠ê‚≠ê‚≠ê ‚Ä¢ City Center</p>
                                                    <span className="font-bold text-gray-400 text-xs mt-2 block">‚Çπ12,000/n</span>
                                                </div>
                                            </div>
                                        </div>
                                    )}

                                    {/* DETAILED ITINERARY */}
                                    {msg.type === 'itinerary' && (
                                        <div className="bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden">
                                            <div className="bg-pink-50 p-3 border-b"><h3 className="font-bold text-pink-900 text-xs">3-Day Jaipur Plan</h3></div>
                                            <div className="p-4 relative">
                                                <div className="absolute left-[20px] top-4 bottom-4 w-0.5 bg-gray-200"></div>
                                                
                                                {/* Day 1 */}
                                                <div className="mb-4 relative z-10">
                                                    <div className="bg-white border border-gray-200 p-2 rounded-lg shadow-sm flex gap-3 items-start">
                                                        <div className="w-8 h-8 rounded-full bg-orange-100 flex items-center justify-center text-md shrink-0">üè∞</div>
                                                        <div>
                                                            <h4 className="font-bold text-xs text-gray-800">Day 1: The Royals</h4>
                                                            <ul className="text-[10px] text-gray-500 list-disc ml-3 mt-1">
                                                                <li>Arrival & Hotel Check-in</li>
                                                                <li>Amer Fort (Elephant Ride)</li>
                                                                <li>Dinner at Chokhi Dhani</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>

                                                {/* Day 2 */}
                                                <div className="mb-4 relative z-10">
                                                    <div className="bg-white border border-gray-200 p-2 rounded-lg shadow-sm flex gap-3 items-start">
                                                        <div className="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-md shrink-0">üíß</div>
                                                        <div>
                                                            <h4 className="font-bold text-xs text-gray-800">Day 2: Culture & Chill</h4>
                                                            <ul className="text-[10px] text-gray-500 list-disc ml-3 mt-1">
                                                                <li>City Palace Museum</li>
                                                                <li>Pool time at Haveli</li>
                                                                <li>Shopping at Bapu Bazaar</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>

                                                {/* Day 3 */}
                                                <div className="relative z-10">
                                                    <div className="bg-white border border-gray-200 p-2 rounded-lg shadow-sm flex gap-3 items-start">
                                                        <div className="w-8 h-8 rounded-full bg-green-100 flex items-center justify-center text-md shrink-0">‚úàÔ∏è</div>
                                                        <div>
                                                            <h4 className="font-bold text-xs text-gray-800">Day 3: Departure</h4>
                                                            <p className="text-[10px] text-gray-500">Breakfast & Airport Drop</p>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <button onClick={() => handleInteraction('CONFIRM_ITINERARY')} className="w-full bg-gray-900 text-white py-2 text-xs font-bold hover:bg-black">Confirm This Plan</button>
                                        </div>
                                    )}

                                    {/* INVOICE */}
                                    {msg.type === 'invoice' && (
                                        <div className="bg-white rounded-xl shadow border p-4">
                                            <h3 className="font-bold text-gray-900 border-b pb-2 mb-2 text-sm">Total Estimate (3 Pax)</h3>
                                            <div className="space-y-1 text-xs text-gray-600 mb-3">
                                                <div className="flex justify-between"><span>Flights (Delhi-Jaipur)</span><span>‚Çπ12,600</span></div>
                                                <div className="flex justify-between"><span>Haveli (2 Rooms, 2N)</span><span>‚Çπ34,000</span></div>
                                                <div className="flex justify-between"><span>Activity Pass</span><span>‚Çπ4,500</span></div>
                                                <div className="flex justify-between text-green-600"><span>Early Bird Offer</span><span>-‚Çπ3,000</span></div>
                                                <div className="flex justify-between text-gray-900 font-bold border-t pt-2 mt-2 text-sm"><span>To Pay</span><span>‚Çπ48,100</span></div>
                                            </div>
                                            <button onClick={() => handleInteraction('PAY_NOW')} className="w-full bg-pink-600 text-white py-3 rounded-xl font-bold text-xs hover:bg-pink-700">Pay Now</button>
                                        </div>
                                    )}

                                    {/* QR CODE */}
                                    {msg.type === 'qr' && (
                                        <div className="bg-white rounded-xl shadow border p-1 overflow-hidden">
                                            <div className="bg-gray-100 p-2 text-center text-[10px] text-gray-500">UPI Payment Gateway</div>
                                            <div className="p-4 flex justify-center relative">
                                                <div className="relative border-2 border-gray-800 p-2 rounded bg-white">
                                                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=upi://pay?pa=yatrafy@upi&pn=Yatrafy" className="w-32 h-32"/>
                                                    <div className="scan-laser"></div>
                                                </div>
                                            </div>
                                            <button onClick={() => handleInteraction('SCAN_SUCCESS')} className="w-full bg-green-50 text-green-700 py-2 font-bold text-xs border-t border-green-100">Click to Simulate Success</button>
                                        </div>
                                    )}

                                    {/* SUCCESS */}
                                    {msg.type === 'success' && (
                                        <div className="bg-green-600 text-white p-5 rounded-xl text-center shadow-lg">
                                            <div className="w-10 h-10 bg-white rounded-full flex items-center justify-center mx-auto mb-2 text-green-600 text-xl">‚úì</div>
                                            <h2 className="font-bold text-lg">Trip Confirmed!</h2>
                                            <p className="text-xs text-green-100">Booking ID: #JPR-8821</p>
                                        </div>
                                    )}

                                    {/* DOWNLOADS */}
                                    {msg.type === 'downloads' && (
                                        <div className="bg-white rounded-xl shadow border divide-y">
                                            <div className="p-3 flex items-center justify-between cursor-pointer hover:bg-gray-50">
                                                <div className="flex items-center gap-2">
                                                    <div className="bg-red-100 p-1.5 rounded text-red-500 font-bold text-xs">PDF</div>
                                                    <span className="text-xs font-bold text-gray-700">Flight_Tickets.pdf</span>
                                                </div>
                                                <span className="text-gray-400">‚¨á</span>
                                            </div>
                                            <div className="p-3 flex items-center justify-between cursor-pointer hover:bg-gray-50">
                                                <div className="flex items-center gap-2">
                                                    <div className="bg-blue-100 p-1.5 rounded text-blue-500 font-bold text-xs">PDF</div>
                                                    <span className="text-xs font-bold text-gray-700">Itinerary_Full.pdf</span>
                                                </div>
                                                <span className="text-gray-400">‚¨á</span>
                                            </div>
                                        </div>
                                    )}

                                </div>
                            </div>
                        ))}

                        {/* TYPING INDICATOR */}
                        {isTyping && (
                            <div className="flex justify-start w-full">
                                <div className="w-8 h-8 rounded-full bg-pink-100 flex items-center justify-center mr-2"><span className="text-lg">ü§ñ</span></div>
                                <div className="bg-gray-200 rounded-2xl rounded-bl-none p-3 px-4 flex gap-1 items-center h-10">
                                    <div className="w-1.5 h-1.5 bg-gray-500 rounded-full animate-bounce"></div>
                                    <div className="w-1.5 h-1.5 bg-gray-500 rounded-full animate-bounce delay-75"></div>
                                    <div className="w-1.5 h-1.5 bg-gray-500 rounded-full animate-bounce delay-150"></div>
                                </div>
                            </div>
                        )}
                        <div ref={chatEndRef} />
                    </div>

                    {/* Input Placeholder (Visual Only) */}
                    <div className="bg-white p-3 border-t z-20">
                        <div className="flex gap-2 items-center bg-gray-50 px-4 py-3 rounded-full border">
                            <input 
                                type="text" 
                                placeholder="Select an option above..."
                                className="bg-transparent flex-1 outline-none text-sm text-gray-500"
                                disabled
                            />
                            <div className="bg-pink-300 p-2 rounded-full text-white">‚û§</div>
                        </div>
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<YatrafyApp />);
    </script>
</body>
</html>
